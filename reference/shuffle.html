<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Data shuffling and General Additive Data Perturbation."><title>Shuffling and EGADP — shuffle • sdcMicro</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Shuffling and EGADP — shuffle"><meta property="og:description" content="Data shuffling and General Additive Data Perturbation."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">sdcMicro</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">5.7.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/sdcMicro.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/recordSwapping.html">Targeted Record Swapping</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/sdcTools/sdcMicro/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Shuffling and EGADP</h1>
      <small class="dont-index">Source: <a href="https://github.com/sdcTools/sdcMicro/blob/HEAD/R/shuffle.R" class="external-link"><code>R/shuffle.R</code></a></small>
      <div class="d-none name"><code>shuffle.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Data shuffling and General Additive Data Perturbation.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">shuffle</span><span class="op">(</span></span>
<span>  <span class="va">obj</span>,</span>
<span>  <span class="va">form</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"ds"</span>,</span>
<span>  weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  covmethod <span class="op">=</span> <span class="st">"spearman"</span>,</span>
<span>  regmethod <span class="op">=</span> <span class="st">"lm"</span>,</span>
<span>  gadp <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>obj</dt>
<dd><p>An object of class sdcMicroObj or a data.frame including the
data.</p></dd>


<dt>form</dt>
<dd><p>An object of class “formula” (or one that can be coerced
to that class): a symbolic description of the model to be fitted.  The
responses have to consists of at least two variables of any class and the
response variables have to be of class numeric.  The response variables
belongs to numeric key variables (quasi-identifiers of numeric scale). The
predictors are can be distributed in any way (numeric, factor, ordered
factor).</p></dd>


<dt>method</dt>
<dd><p>currently either the original form of data shuffling
(“ds” - default), “mvn” or “mlm”, see the details
section. The last method is in experimental mode and almost untested.</p></dd>


<dt>weights</dt>
<dd><p>Survey sampling weights. Automatically chosen when obj is of
class <code><a href="sdcMicroObj-class.html">sdcMicroObj-class</a></code>.</p></dd>


<dt>covmethod</dt>
<dd><p>Method for covariance estimation. “spearman”,
“pearson” and \ dQuotemcd are possible. For the latter one, the
implementation in package robustbase is used.</p></dd>


<dt>regmethod</dt>
<dd><p>Method for multivariate regression. “lm” and
“MM” are possible.  For method “MM”, the function “rlm”
from package MASS is applied.</p></dd>


<dt>gadp</dt>
<dd><p>TRUE, if the egadp results from a fit on the original data is
returned.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>If ‘obj’ is of class <code><a href="sdcMicroObj-class.html">sdcMicroObj-class</a></code> the corresponding
slots are filled, like manipNumVars, risk and utility.  If ‘obj’ is
of class “data.frame” an object of class “micro” with
following entities is returned:</p>
<dl><dt>shConf </dt>
<dd><p>the shuffled numeric key
variables</p></dd>
 <dt>egadp </dt>
<dd><p>the perturbed (using gadp method) numeric key
variables</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Perturbed values for the sensitive variables are generated.  The sensitive
variables have to be stored as responses in the argument ‘form’,
which is the usual formula interface for regression models in R.</p>
<p>For method “ds” the EGADP method is applied on the norm inverse
percentiles. Shuffling then ranks the original values according to the GADP
output. For further details, please see the references.</p>
<p>Method “mvn” uses a simplification and draws from the normal Copulas
directly before these draws are shuffled.</p>
<p>Method “mlm” is also a simplification. A linear model is applied, the
expected values are used as perturbed values before shuffling is
applied.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>In this version, the covariance method chosen is used for any
covariance and correlation estimations in the whole gadp and shuffling
function.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>K. Muralidhar, R. Parsa, R. Saranthy (1999). A general additive
data perturbation method for database security. <em>Management Science</em>,
45, 1399-1415.</p>
<p>K. Muralidhar, R. Sarathy (2006). Data shuffling - a new masking approach
for numerical data. <em>Management Science</em>, 52(5), 658-670, 2006.</p>
<p>M. Templ, B. Meindl. (2008).  Robustification of Microdata Masking Methods
and the Comparison with Existing Methods, in: <em>Lecture Notes on
Computer Science</em>, J. Domingo-Ferrer, Y. Saygin (editors.); Springer,
Berlin/Heidelberg, 2008, ISBN: 978-3-540-87470-6, pp. 14-25.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="rankSwap.html">rankSwap</a>, <a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Matthias Templ, Alexander Kowarik, Bernhard Meindl</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Prestige</span>,package<span class="op">=</span><span class="st">"carData"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">form</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></span><span class="op">(</span><span class="va">income</span> <span class="op">+</span> <span class="va">education</span> <span class="op">~</span> <span class="va">women</span> <span class="op">+</span> <span class="va">prestige</span> <span class="op">+</span> <span class="va">type</span>, data<span class="op">=</span><span class="va">Prestige</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sh</span> <span class="op">&lt;-</span> <span class="fu">shuffle</span><span class="op">(</span>obj<span class="op">=</span><span class="va">Prestige</span>,<span class="va">form</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>rows with missing values have been imputed!</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Prestige</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"income"</span>, <span class="st">"education"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="shuffle-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sh</span><span class="op">$</span><span class="va">sh</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="shuffle-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">Prestige</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"income"</span>, <span class="st">"education"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     income  education </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6797.90196   10.73804 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">sh</span><span class="op">$</span><span class="va">sh</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     income  education </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6797.90196   10.73804 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">Prestige</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"income"</span>, <span class="st">"education"</span><span class="op">)</span><span class="op">]</span>, method<span class="op">=</span><span class="st">"spearman"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             income education</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> income    1.000000  0.573999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> education 0.573999  1.000000</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">sh</span><span class="op">$</span><span class="va">sh</span>, method<span class="op">=</span><span class="st">"spearman"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              income education</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> income    1.0000000 0.5565376</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> education 0.5565376 1.0000000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## for objects of class sdcMicro:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">testdata2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sdc</span> <span class="op">&lt;-</span> <span class="fu"><a href="sdcMicroObj-class.html">createSdcObj</a></span><span class="op">(</span><span class="va">testdata2</span>,</span></span>
<span class="r-in"><span>  keyVars<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'urbrur'</span>,<span class="st">'roof'</span>,<span class="st">'walls'</span>,<span class="st">'water'</span>,<span class="st">'electcon'</span>,<span class="st">'relat'</span>,<span class="st">'sex'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  numVars<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'expend'</span>,<span class="st">'income'</span>,<span class="st">'savings'</span><span class="op">)</span>, w<span class="op">=</span><span class="st">'sampling_weight'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sdc</span> <span class="op">&lt;-</span> <span class="fu">shuffle</span><span class="op">(</span><span class="va">sdc</span>, method<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'ds'</span><span class="op">)</span>,regmethod<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'lm'</span><span class="op">)</span>, covmethod<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'spearman'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    form<span class="op">=</span><span class="va">savings</span><span class="op">+</span><span class="va">expend</span> <span class="op">~</span> <span class="va">urbrur</span><span class="op">+</span><span class="va">walls</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Matthias Templ, Bernhard Meindl, Alexander Kowarik, Johannes Gussenbauer.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

